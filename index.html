<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aplicaci√≥n Web VR - Examen Tema 4</title>
    
    <!-- A-Frame VR Framework -->
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.1/dist/aframe-extras.min.js"></script>
    
    <!-- Super Hands para agarre de objetos -->
    <script src="https://cdn.jsdelivr.net/gh/wmurphyrd/aframe-super-hands-component@v3.0.3/dist/super-hands.min.js"></script>

    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: #000;
        }
        
        #loadingScreen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            color: white;
            text-align: center;
        }
        
        .loader {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 2s linear infinite;
            margin-bottom: 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        #instructions {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            max-width: 300px;
            z-index: 100;
        }
    </style>
</head>
<body>
    <!-- Pantalla de carga -->
    <div id="loadingScreen">
        <div class="loader"></div>
        <h2>Cargando Aplicaci√≥n VR</h2>
        <p>Preparando escenario inmersivo...</p>
        <p><small>Compatible con Meta Quest 3</small></p>
    </div>
    
    <!-- Instrucciones -->
    <div id="instructions">
        <h3>ü•Ω Instrucciones VR Mejoradas</h3>
        <p><strong>PC:</strong> WASD para moverte, mouse para mirar</p>
        <p><strong>VR:</strong> Joysticks para moverte, manos para interactuar</p>
        <p><strong>Interacci√≥n:</strong> Todos los objetos son interactivos</p>
        <p>‚ú® Objetos distribuidos por todo el espacio</p>
    </div>

    <!-- Escena A-Frame -->
    <a-scene 
        vr-mode-ui="enabled: true" 
        background="color: #87CEEB"
        fog="type: linear; color: #87CEEB; near: 20; far: 100">
        
        <!-- Assets -->
        <a-assets>
            <!-- Intentar cargar el modelo GLB si existe -->
            <a-asset-item id="bathroom-model" src="./assets/the_bathroom_free.glb"></a-asset-item>
        </a-assets>

        <!-- Iluminaci√≥n mejorada -->
        <a-light type="ambient" color="#404040" intensity="0.6"></a-light>
        <a-light type="directional" position="5 10 5" color="#ffffff" intensity="0.8"></a-light>
        <a-light type="point" position="0 5 0" color="#ffaa00" intensity="0.4"></a-light>
        <a-light type="spot" position="-3 6 -6" color="#ff6600" intensity="0.3" angle="45"></a-light>

        <!-- Modelo del ba√±o (si existe) -->
        <a-entity 
            id="bathroom-scene"
            gltf-model="#bathroom-model" 
            position="0 0 0" 
            scale="1 1 1"
            visible="false">
        </a-entity>

        <!-- Entorno b√°sico de ba√±o creado con primitivas - TODOS INTERACTIVOS -->
        <a-entity id="bathroom-environment">
            <!-- Suelo del ba√±o - INTERACTIVO -->
            <a-plane 
                id="floor"
                position="0 0 -3" 
                rotation="-90 0 0" 
                width="12" 
                height="12"
                material="color: #E6E6FA; roughness: 0.8"
                shadow="receive: true"
                class="interactive-object environment-object">
            </a-plane>
            
            <!-- Paredes - INTERACTIVAS -->
            <a-plane 
                id="wall-back"
                position="0 4 -9" 
                width="12" 
                height="8" 
                material="color: #F0F8FF"
                class="interactive-object environment-object">
            </a-plane>
            <a-plane 
                id="wall-left"
                position="-6 4 -3" 
                rotation="0 90 0" 
                width="12" 
                height="8" 
                material="color: #F0F8FF"
                class="interactive-object environment-object">
            </a-plane>
            <a-plane 
                id="wall-right"
                position="6 4 -3" 
                rotation="0 -90 0" 
                width="12" 
                height="8" 
                material="color: #F0F8FF"
                class="interactive-object environment-object">
            </a-plane>
            
            <!-- Ba√±era b√°sica - INTERACTIVA -->
            <a-box 
                id="bathtub"
                position="-3 0.5 -7" 
                width="2.5" 
                height="1" 
                depth="4" 
                material="color: #FFFFFF; metalness: 0.3"
                class="interactive-object environment-object">
            </a-box>
            
            <!-- Lavabo - INTERACTIVO -->
            <a-cylinder 
                id="sink"
                position="3 1 -7" 
                radius="0.8" 
                height="0.2" 
                material="color: #FFFFFF; metalness: 0.4"
                class="interactive-object environment-object">
            </a-cylinder>
            <a-box 
                id="sink-cabinet"
                position="3 0.5 -7" 
                width="1.8" 
                height="1" 
                depth="1" 
                material="color: #8B4513"
                class="interactive-object environment-object">
            </a-box>
            
            <!-- Inodoro - INTERACTIVO -->
            <a-cylinder 
                id="toilet"
                position="0 0.4 -8" 
                radius="0.4" 
                height="0.8" 
                material="color: #FFFFFF; metalness: 0.2"
                class="interactive-object environment-object">
            </a-cylinder>
            <a-box 
                id="toilet-tank"
                position="0 0.8 -8.3" 
                width="0.8" 
                height="0.4" 
                depth="0.3" 
                material="color: #FFFFFF"
                class="interactive-object environment-object">
            </a-box>

            <!-- Espejo - INTERACTIVO -->
            <a-plane 
                id="mirror"
                position="3 2.5 -6.9" 
                width="1.5" 
                height="1.5" 
                material="color: #C0C0C0; metalness: 1.0; roughness: 0.1"
                class="interactive-object environment-object">
            </a-plane>
        </a-entity>

        <!-- 16 Objetos 3D interactivos DISTRIBUIDOS POR TODO EL ESPACIO -->
        
        <!-- 1. Esquina frontal izquierda lejana -->
        <a-box 
            id="cube1"
            position="-6 1.5 3" 
            scale="0.5 0.5 0.5"
            material="color: #FF6B6B; metalness: 0.3"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 360 360 360; loop: true; dur: 8000">
        </a-box>

        <!-- 2. Esquina frontal derecha lejana -->
        <a-sphere 
            id="sphere1"
            position="6 2 3" 
            radius="0.4"
            material="color: #4ECDC4; metalness: 0.5"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 180 360 270; loop: true; dur: 6000">
        </a-sphere>

        <!-- 3. Lado izquierdo medio -->
        <a-cylinder 
            id="cylinder1"
            position="-7 1 -1" 
            radius="0.3" 
            height="1"
            material="color: #45B7D1; roughness: 0.4"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 270 180 360; loop: true; dur: 7000">
        </a-cylinder>

        <!-- 4. Lado derecho medio -->
        <a-cone 
            id="cone1"
            position="7 1.5 -1" 
            radius-bottom="0.4" 
            height="0.8"
            material="color: #FF6347; metalness: 0.3"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 360 270 180; loop: true; dur: 5000">
        </a-cone>

        <!-- 5. Centro alto -->
        <a-torus 
            id="torus1"
            position="0 4 -3" 
            radius="0.4" 
            radius-tubular="0.1"
            material="color: #9ACD32; metalness: 0.6"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 180 360 90; loop: true; dur: 9000">
        </a-torus>

        <!-- 6. Esquina trasera izquierda -->
        <a-octahedron 
            id="octahedron1"
            position="-5 2.5 -9" 
            radius="0.4"
            material="color: #DDA0DD; metalness: 0.7"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 360 180 360; loop: true; dur: 4000">
        </a-octahedron>

        <!-- 7. Esquina trasera derecha -->
        <a-dodecahedron 
            id="dodecahedron1"
            position="5 1.8 -9" 
            radius="0.3"
            material="color: #FF69B4; roughness: 0.4"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 270 360 180; loop: true; dur: 6500">
        </a-dodecahedron>

        <!-- 8. Cerca de la ba√±era izquierda -->
        <a-icosahedron 
            id="icosahedron1"
            position="-2 1.5 -7" 
            radius="0.35"
            material="color: #20B2AA; metalness: 0.8"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 360 90 270; loop: true; dur: 7500">
        </a-icosahedron>

        <!-- 9. Cerca del lavabo derecha -->
        <a-tetrahedron 
            id="tetrahedron1"
            position="2 2.5 -6" 
            radius="0.4"
            material="color: #FFD700; metalness: 0.5"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 180 270 360; loop: true; dur: 5500">
        </a-tetrahedron>

        <!-- 10. Centro frontal -->
        <a-plane 
            id="plane1"
            position="0 2 1" 
            width="1" 
            height="1"
            material="color: #87CEEB; side: double"
            rotation="45 30 15"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 405 390 375; loop: true; dur: 8500">
        </a-plane>

        <!-- 11. Alto izquierda -->
        <a-ring 
            id="ring1"
            position="-3 3.5 -2" 
            radius-inner="0.2" 
            radius-outer="0.4"
            material="color: #FF4500; side: double; metalness: 0.7"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 360 180 270; loop: true; dur: 6000">
        </a-ring>

        <!-- 12. Alto derecha -->
        <a-box 
            id="cube2"
            position="3 3.5 -2" 
            scale="0.6 0.6 0.6"
            material="color: #00CED1; wireframe: true"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 270 360 90; loop: true; dur: 4500">
        </a-box>

        <!-- 13. Lado izquierdo frontal -->
        <a-sphere 
            id="sphere2"
            position="-4 1.5 2" 
            radius="0.35"
            material="color: #C0C0C0; metalness: 1.0; roughness: 0.1"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 360 270 180; loop: true; dur: 7000">
        </a-sphere>

        <!-- 14. Lado derecho frontal -->
        <a-cylinder 
            id="cylinder2"
            position="4 1.2 2" 
            radius="0.4" 
            height="0.8"
            material="color: #8A2BE2; transparent: true; opacity: 0.7"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 180 360 270; loop: true; dur: 5800">
        </a-cylinder>

        <!-- 15. Centro bajo -->
        <a-cone 
            id="cone2"
            position="1 0.8 -4" 
            radius-bottom="0.3" 
            height="0.6"
            rotation="180 0 0"
            material="color: #32CD32; roughness: 0.6"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 540 360 180; loop: true; dur: 6200">
        </a-cone>

        <!-- 16. Alto centro trasero -->
        <a-torus-knot 
            id="torusknot1"
            position="0 4.5 -8" 
            radius="0.3" 
            radius-tubular="0.05"
            material="color: #FF1493; metalness: 0.8"
            class="interactive-object floating-object grabbable"
            animation="property: rotation; to: 360 180 360; loop: true; dur: 9500">
        </a-torus-knot>

        <!-- C√°mara y controles mejorados -->
        <a-entity 
            id="rig" 
            position="0 1.6 4"
            movement-controls="fly: false; constrainToNavMesh: false">
            
            <a-camera 
                id="camera"
                look-controls="pointerLockEnabled: true"
                wasd-controls="acceleration: 20">
                
                <a-cursor 
                    id="cursor"
                    position="0 0 -1"
                    geometry="primitive: ring; radiusInner: 0.02; radiusOuter: 0.03"
                    material="color: white; shader: flat"
                    raycaster="objects: .interactive-object">
                </a-cursor>
            </a-camera>

            <!-- Controles VR mejorados con agarre -->
            <a-entity 
                id="leftHand"
                hand-controls="hand: left; handModelStyle: lowPoly; color: #ffcccc"
                vive-controls="hand: left"
                oculus-touch-controls="hand: left"
                windows-motion-controls="hand: left"
                laser-controls="hand: left"
                super-hands="colliderEvent: raycaster-intersection; colliderEventProperty: els; colliderEndEvent: raycaster-intersection-cleared; colliderEndEventProperty: clearedEls"
                raycaster="objects: .interactive-object, .grabbable; lineColor: red; lineOpacity: 0.5">
            </a-entity>

            <a-entity 
                id="rightHand"
                hand-controls="hand: right; handModelStyle: lowPoly; color: #ffcccc"
                vive-controls="hand: right"
                oculus-touch-controls="hand: right"
                windows-motion-controls="hand: right"
                laser-controls="hand: right"
                super-hands="colliderEvent: raycaster-intersection; colliderEventProperty: els; colliderEndEvent: raycaster-intersection-cleared; colliderEndEventProperty: clearedEls"
                raycaster="objects: .interactive-object, .grabbable; lineColor: blue; lineOpacity: 0.5">
            </a-entity>
        </a-entity>
    </a-scene>

    <script src="./js/script.js"></script>
</body>
</html>
